services:
  wwoz-scraper:
    build: .
    container_name: wwoz-scraper
    restart: unless-stopped

    # Load credentials from .env file
    env_file:
      - .env

    environment:
      - CONFIG_PATH=/app/config/config.yaml
      - TZ=America/Chicago
      # Paths for artist discovery pipeline (inside Docker)
      - ARTIST_CARDS_DIR=/artist-cards
      - ARTIST_IMAGES_DIR=/artist-images

    volumes:
      # Configuration file with secrets (read-only)
      - ./config/config.docker.yaml:/app/config/config.yaml:ro

      # Obsidian vault - wwoztracker directory
      # Update archive.basePath in config.yaml to use /vault prefix when running in Docker
      - /Users/maxwell/LETSGO/MaxVault/01_Projects/wwoztracker:/vault

      # Artist discovery directories
      - /Users/maxwell/LETSGO/MaxVault/01_Projects/PersonalArtistWiki/Artists:/artist-cards
      - /Users/maxwell/LETSGO/MaxVault/03_Resources/source_material/ArtistPortraits:/artist-images

      # State persistence (processed_archives.json, etc.)
      - wwoz-state:/app/config/state

    # Enable interactive mode support
    stdin_open: true
    tty: true

volumes:
  wwoz-state:
    name: wwoz-scraper-state
