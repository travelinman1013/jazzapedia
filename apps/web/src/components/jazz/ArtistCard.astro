---
/**
 * ArtistCard Component
 * Displays an artist preview with portrait, name, and key info
 * Jazz club aesthetic with brass accents and warm lighting feel
 */
import Card from '../ui/Card.astro';
import Badge from '../ui/Badge.astro';

interface Props {
  name: string;
  slug: string;
  portrait?: string;
  genres?: string[];
  popularity?: number;
  artistType?: string;
  class?: string;
}

const {
  name,
  slug,
  portrait,
  genres = [],
  popularity,
  artistType,
  class: className = '',
  ...rest
} = Astro.props;

const href = `/artists/${slug}`;
const displayGenres = genres.slice(0, 2);
---

<Card
  variant="default"
  padding="none"
  href={href}
  interactive
  class={`artist-card group ${className}`}
  {...rest}
>
  <!-- Portrait -->
  <div class="aspect-square relative overflow-hidden bg-wiki-bg-nav">
    {portrait ? (
      <img
        src={portrait}
        alt={name}
        loading="lazy"
        decoding="async"
        class="w-full h-full object-cover transition-transform duration-slow group-hover:scale-105"
      />
    ) : (
      <div class="w-full h-full flex items-center justify-center text-wiki-text-muted">
        <span class="text-4xl opacity-50">&#9835;</span>
      </div>
    )}

    <!-- Gradient overlay -->
    <div class="absolute inset-0 bg-gradient-to-t from-jazz-black/80 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-normal" />

    <!-- Popularity indicator -->
    {popularity !== undefined && (
      <div class="absolute top-2 right-2 px-2 py-1 bg-jazz-black/70 backdrop-blur-sm rounded text-xs font-mono text-jazz-amber">
        {popularity}
      </div>
    )}

    <!-- Artist type indicator -->
    {artistType && (
      <div class="absolute bottom-2 left-2 opacity-0 group-hover:opacity-100 transition-opacity duration-normal">
        <Badge variant="glow" size="sm">
          {artistType}
        </Badge>
      </div>
    )}
  </div>

  <!-- Info -->
  <div class="p-3">
    <h3 class="font-display font-semibold text-wiki-text-heading truncate group-hover:text-wiki-accent transition-colors duration-fast">
      {name}
    </h3>

    {displayGenres.length > 0 && (
      <div class="mt-1 flex flex-wrap gap-1">
        {displayGenres.map(genre => (
          <span class="text-xs text-wiki-text-muted">
            {genre}
          </span>
        ))}
        {genres.length > 2 && (
          <span class="text-xs text-wiki-text-muted">
            +{genres.length - 2}
          </span>
        )}
      </div>
    )}
  </div>
</Card>

<style>
  .artist-card {
    position: relative;
  }

  .artist-card::before {
    content: '';
    position: absolute;
    inset: -1px;
    border-radius: inherit;
    padding: 1px;
    background: linear-gradient(135deg, transparent 0%, var(--jazz-amber) 50%, var(--electric-cyan) 100%);
    -webkit-mask:
      linear-gradient(#fff 0 0) content-box,
      linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    opacity: 0;
    transition: opacity var(--duration-normal) var(--ease-jazz);
    pointer-events: none;
  }

  .artist-card:hover::before {
    opacity: 1;
  }
</style>
